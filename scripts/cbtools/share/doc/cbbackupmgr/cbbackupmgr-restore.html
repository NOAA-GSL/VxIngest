<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="description" content="Restores data from the backup archive to a Couchbase cluster">
<meta name="author" content="Couchbase">
<title>cbbackupmgr-restore(1)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="manpage">
<div id="header">
<h1>cbbackupmgr-restore(1) Manual Page</h1>
<h2 id="_name">NAME</h2>
<div class="sectionbody">
<p>cbbackupmgr-restore - Restores data from the backup archive to a Couchbase cluster</p>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_synopsis">SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content">cbbackupmgr restore [--archive &lt;archive_dir&gt;] [--repo &lt;repo_name&gt;]
                    [--cluster &lt;host&gt;] [--username &lt;username&gt;]
                    [--password &lt;password&gt;] [--client-cert &lt;path&gt;]
                    [--client-cert-password &lt;password&gt;] [--client-key &lt;path&gt;]
                    [--client-key-password &lt;password&gt;] [--start &lt;start&gt;]
                    [--end &lt;end&gt;] [--include-data &lt;collection_string_list&gt;]
                    [--exclude-data &lt;collection_string_list&gt;]
                    [--map-data &lt;collection_string_mappings&gt;]
                    [--disable-cluster-analytics] [--disable-analytics]
                    [--disable-views] [--disable-gsi-indexes]
                    [--disable-ft-indexes] [--disable-ft-alias]
                    [--disable-data] [--disable-eventing]
                    [--disable-bucket-query] [--disable-cluster-query]
                    [--replace-ttl &lt;type&gt;]
                    [--replace-ttl-with &lt;timestamp&gt;] [--force-updates]
                    [--threads &lt;integer&gt;] [--vbucket-filter &lt;integer_list&gt;]
                    [--no-progress-bar] [--auto-create-buckets]
                    [--autoremove-collections] [--continue-on-cs-failure]
                    [--restore-partial-backups] [--obj-access-key-id &lt;access_key_id&gt;]
                    [--obj-cacert &lt;cert_path&gt;] [--obj-endpoint &lt;endpoint&gt;]
                    [--obj-read-only-mode] [--obj-no-ssl-verify]
                    [--obj-region &lt;region&gt;] [--obj-staging-dir &lt;staging_dir&gt;]
                    [--obj-secret-access-key &lt;secret_access_key&gt;]
                    [--s3-force-path-style] [--s3-log-level &lt;level&gt;]
                    [--point-in-time &lt;time&gt;]
                    [--filter-keys &lt;regexp&gt;] [--filter-values &lt;regexp&gt;]
                    [--passphrase &lt;passphrase&gt;] [--km-key-url &lt;url&gt;]
                    [--km-endpoint &lt;endpoint&gt;] [--km-region &lt;region&gt;]
                    [--km-access-key-id &lt;id&gt;] [--km-secret-access-key &lt;key&gt;]
                    [--km-auth-file &lt;path&gt;] [--purge] [--resume]</pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_description">DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Restores data from the backup archive to a target Couchbase cluster. By default
all data, index definitions, view definitions and full-text index definitions
are restored to the cluster unless specified otherwise in the repos backup
config or through command line parameters when running the restore command.</p>
</div>
<div class="paragraph">
<p>The restore command is capable of restoring a single backup or a range of
backups. When restoring a single backup, all data from that backup is restored.
If a range of backups is restored, then cbbackupmgr will take into account
any failovers that may have occurred in between the time that the backups were
originally taken. If a failover did occur in between the backups, and the backup
archive contains data that no longer exists in the cluster, then the data that
no longer exists will be skipped during the restore. If no failovers occurred in
between backups then restoring a range of backups will restore all data from
each backup. If all data must be restored regardless of whether a failover
occurred in between the original backups, then data should be restored one
backup at a time.</p>
</div>
<div class="paragraph">
<p>The restore command is guaranteed to work during rebalances and failovers. If a
rebalance is taking place, cbbackupmgr will track the movement of vbuckets
around a Couchbase cluster and ensure that data is restored to the appropriate
node. If a failover occurs during the restore then the client will wait 180
seconds for the failed node to be removed from the cluster. If the failed node
is not removed in 180 seconds then the restore will fail, but if the failed node
is removed before the timeout then data will continue to be restored.</p>
</div>
<div class="paragraph">
<p>Note that if you are restoring indexes then it is highly likely that you will
need to take some manual steps in order to properly restore them. This is
because by default indexes will only be built if they are restored to the exact
same index node that they were backed up from. If the index node they were
backed up from does not exist then the indexes will be restored in round-robin
fashion among the current indexer nodes. These indexes will be created, but not
built and will required the administrator to manually build them. We do this
because we cannot know the optimal index topology ahead of time. By not building
the indexes the administrator can move each index between nodes and build them
when they deem that the index topology is optimal.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_options">OPTIONS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Below is a list of required and optional parameters for the restore command.</p>
</div>
<div class="sect2">
<h3 id="_required">Required</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">-a,--archive &lt;archive_dir&gt;</dt>
<dd>
<p>The directory containing the backup repository to restore data from. When
restoring from an archive stored in S3 prefix the archive path with
<code>s3://${BUCKET_NAME}/</code>.</p>
</dd>
<dt class="hdlist1">-r,--repo &lt;repo_name&gt;</dt>
<dd>
<p>The name of the backup repository to restore data from.</p>
</dd>
<dt class="hdlist1">-c,--cluster &lt;hostname&gt;</dt>
<dd>
<p>The hostname of one of the nodes in the cluster to restore data to. See the
Host Formats section below for hostname specification details.</p>
</dd>
<dt class="hdlist1">-u,--username &lt;username&gt;</dt>
<dd>
<p>The username for cluster authentication. The user must have the appropriate
privileges to take a backup.</p>
</dd>
<dt class="hdlist1">-p,--password &lt;password&gt;</dt>
<dd>
<p>The password for cluster authentication. The user must have the appropriate
privileges to take a backup. If not password is supplied to this option then
you will be prompted to enter your password.</p>
</dd>
<dt class="hdlist1">--client-cert &lt;path&gt;</dt>
<dd>
<p>The path to a client certificate used to authenticate when connecting to a
cluster. May be supplied with <code>--client-key</code> as an alternative to the
<code>--username</code> and <code>--password</code> flags.  See the CERTIFICATE AUTHENTICATION
section for more information.</p>
</dd>
<dt class="hdlist1">--client-cert-password &lt;password&gt;</dt>
<dd>
<p>The password for the certificate provided to the <code>--client-cert</code> flag, when
using this flag, the certificate/key pair is expected to be in the PKCS#12
format. See the CERTIFICATE AUTHENTICATION section for more information.</p>
</dd>
<dt class="hdlist1">--client-key &lt;path&gt;</dt>
<dd>
<p>The path to the client private key whose public key is contained in the
certificate provided to the <code>--client-cert</code> flag. May be supplied with
<code>--client-cert</code> as an alternative to the <code>--username</code> and <code>--password</code>
flags. See the CERTIFICATE AUTHENTICATION section for more information.</p>
</dd>
<dt class="hdlist1">--client-key-password &lt;password&gt;</dt>
<dd>
<p>The password for the key provided to the <code>--client-key</code> flag, when using this
flag, the key is expected to be in the PKCS#8 format.  See the CERTIFICATE
AUTHENTICATION section for more information.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_optional">Optional</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">--start &lt;start&gt;</dt>
<dd>
<p>The first backup to restore. See START AND END for information on what values
are accepted.</p>
</dd>
<dt class="hdlist1">--end &lt;end&gt;</dt>
<dd>
<p>The final backup to restore. See START AND END for information on what values
are accepted.</p>
</dd>
<dt class="hdlist1">--include-data &lt;collection_string_list&gt;</dt>
<dd>
<p>Overrides the repository configuration to restore only the data specified in
the &lt;collection_string_list&gt;. This flag takes a comma separated list of
collection strings and can&#8217;t be specified at the same time as
<code>--exclude-data</code>. Note that including data at the scope/collection level is
an Enterprise Edition feature.</p>
</dd>
<dt class="hdlist1">--exclude-data &lt;collection_string_list&gt;</dt>
<dd>
<p>Overrides the repository configuration to skip restoring the data specified
in the &lt;collection_string_list&gt;. This flag takes a comma separated list of
collection strings and can&#8217;t be specified at the same time as
<code>--include-data</code>. Note that excluding data at the scope/collection level is
an Enterprise Edition feature.</p>
</dd>
<dt class="hdlist1">--filter-keys</dt>
<dd>
<p>Only restore data where the key matches a particular regular expression.
The regular expressions provided must follow
<a href="https://github.com/google/re2/wiki/Syntax">RE2 syntax</a>.</p>
</dd>
<dt class="hdlist1">--filter-values</dt>
<dd>
<p>Only restore data where the value matches a particular regular expression.
The regular expressions provided must follow
<a href="https://github.com/google/re2/wiki/Syntax">RE2 syntax</a>.</p>
</dd>
<dt class="hdlist1">--enable-bucket-config</dt>
<dd>
<p>Enables restoring the bucket configuration.</p>
</dd>
<dt class="hdlist1">--disable-views</dt>
<dd>
<p>Skips restoring view definitions for all buckets.</p>
</dd>
<dt class="hdlist1">--disable-gsi-indexes</dt>
<dd>
<p>Skips restoring gsi index definitions for all buckets.</p>
</dd>
<dt class="hdlist1">--disable-ft-indexes</dt>
<dd>
<p>Skips restoring full-text index definitions for all buckets.</p>
</dd>
<dt class="hdlist1">--disable-ft-alias</dt>
<dd>
<p>Skips restoring full-text alias definitions.</p>
</dd>
<dt class="hdlist1">--disable-data</dt>
<dd>
<p>Skips restoring all key-value data for all buckets.</p>
</dd>
<dt class="hdlist1">--disable-cluster-analytics</dt>
<dd>
<p>Skips restoring analytics cluster level analytics metadata e.g. Synonyms.</p>
</dd>
<dt class="hdlist1">--disable-analytics</dt>
<dd>
<p>Skips restoring bucket level analytics metadata.</p>
</dd>
<dt class="hdlist1">--disable-eventing</dt>
<dd>
<p>Skips restoring the eventing service metadata.</p>
</dd>
<dt class="hdlist1">--disable-bucket-query</dt>
<dd>
<p>Skips restoring bucket level Query Service metadata.</p>
</dd>
<dt class="hdlist1">--disable-cluster-query</dt>
<dd>
<p>Skips restoring cluster level Query Service metadata.</p>
</dd>
<dt class="hdlist1">--force-updates</dt>
<dd>
<p>Forces data in the Couchbase cluster to be overwritten even if the data in
the cluster is newer. By default updates are not forced and all updates use
Couchbase&#8217;s conflict resolution mechanism to ensure that if newer data
exists on the cluster that is not overwritten by older restore data.</p>
</dd>
<dt class="hdlist1">--map-data &lt;collection_string_mappings&gt;</dt>
<dd>
<p>Specified when you want to restore source data into a different location. For
example this argument may be used to remap buckets/scopes/collections with
the restriction that they must be remapped at the same level. For example a
bucket may only be remapped to a bucket, a scope to a scope and a collection
to a collection. The argument expects a comma separated list of collection
string mappings e.g.
<code>bucket1=bucket2,bucket3.scope1=bucket3.scope2,bucket4.scope.collection1=bucket4.scope.collection2</code>
If used to remap a bucket into a collection then it will only restore data
for the data service and will skip data for all the other services.</p>
</dd>
<dt class="hdlist1">--replace-ttl &lt;type&gt;</dt>
<dd>
<p>Sets a new expiration (time-to-live) value for the specified keys. This
parameter can either be set to "none", "all" or "expired" and should be used
along with the --replace-ttl-with flag. If "none" is supplied then the TTL
values are not changed. If "all" is specified then the TTL values for all
keys are replaced with the value of the --replace-ttl-with flag.  If
"expired" is set then only keys which have already expired will have the
TTL&#8217;s replaced. For more information about the behavior of <code>--replace-ttl</code>
see the REPLACE TTL.</p>
</dd>
<dt class="hdlist1">--replace-ttl-with &lt;timestamp&gt;</dt>
<dd>
<p>Updates the expiration for the keys specified by the --replace-ttl parameter.
The parameter has to be set when --replace-ttl is set to "all". There are two
options, RFC3339 time stamp format (2006-01-02T15:04:05-07:00) or "0". When
"0" is specified the expiration will be removed. Please note that the RFC3339
value is converted to a Unix time stamp on the cbbackupmgr client. It is
important that the time on both the client and the Couchbase Server are the
same to ensure expiry happens correctly. For more information about the
behavior of <code>--replace-ttl-with</code> see the REPLACE TTL.</p>
</dd>
<dt class="hdlist1">--vbucket-filter &lt;list&gt;</dt>
<dd>
<p>Specifies a list of VBuckets that should be restored. VBuckets are specified
as a comma separated list of integers. If this parameter is not set then all
vBuckets which were backed up are restored.</p>
</dd>
<dt class="hdlist1">--no-ssl-verify</dt>
<dd>
<p>Skips the SSL verification phase. Specifying this flag will allow a
connection using SSL encryption, but will not verify the identity of the
server you connect to. You are vulnerable to a man-in-the-middle attack if
you use this flag. Either this flag or the --cacert flag must be specified
when using an SSL encrypted connection.</p>
</dd>
<dt class="hdlist1">--cacert &lt;cert_path&gt;</dt>
<dd>
<p>Specifies a CA certificate that will be used to verify the identity of the
server being connecting to. Either this flag or the --no-ssl-verify flag
must be specified when using an SSL encrypted connection.</p>
</dd>
<dt class="hdlist1">-t,--threads &lt;num&gt;</dt>
<dd>
<p>Specifies the number of concurrent clients to use when restoring data. Fewer
clients means restores will take longer, but there will be less cluster
resources used to complete the restore. More clients means faster restores,
but at the cost of more cluster resource usage. This parameter defaults to 1
if it is not specified and it is recommended that this parameter is not set
to be higher than the number of CPUs on the machine where the restore is
taking place.</p>
</dd>
<dt class="hdlist1">--no-progress-bar</dt>
<dd>
<p>By default, a progress bar is printed to stdout so that the user can see how
long the restore is expected to take, the amount of data that is being
transferred per second, and the amount of data that has been restored.
Specifying this flag disables the progress bar and is useful when running
automated jobs.</p>
</dd>
<dt class="hdlist1">--auto-create-buckets</dt>
<dd>
<p>It will create the destination buckets if not present in the server.</p>
</dd>
<dt class="hdlist1">--autoremove-collections</dt>
<dd>
<p>Automatically delete scopes/collections which are known to be deleted in the
backup. See SCOPE_COLLECTION_DELETION for more details.</p>
</dd>
<dt class="hdlist1">--continue-on-cs-failure</dt>
<dd>
<p>It&#8217;s possible that during a restore, a checksum validation will fail; in this
case the restore will fail fast. Supplying this flag will mean that the restore
will attempt to continue upon receiving a checksum failure. See CHECKSUM FAILURE
for more information.</p>
</dd>
<dt class="hdlist1">--restore-partial-backups</dt>
<dd>
<p>Allow a restore to continue when the final backup in the restore range is
incomplete. This flag is incompatible with the <code>--obj-read-only</code> flag.</p>
</dd>
<dt class="hdlist1">--point-in-time &lt;time&gt;</dt>
<dd>
<p>(Beta) Specifies the point in time to restore to. The value accepted is ISO8601 date
time format (YYYY-MM-DDTHH:MM:SS). This feature is currently in Beta and is not
supported, this should only be used in test environments.</p>
</dd>
<dt class="hdlist1">--purge</dt>
<dd>
<p>If the last restore failed before it finished, then remove it&#8217;s progress
(which is persisted to disk) then restart from zero. Note that only the
restore progress is purge, no backup data will be removed.</p>
</dd>
<dt class="hdlist1">--resume</dt>
<dd>
<p>If the last restore failed before it finished, then try to continue from
where it left off.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_cloud_integration">Cloud integration</h3>
<div class="paragraph">
<p>Native cloud integration is an Enterprise Edition feature which was introduced
in Couchbase Server 6.6.0.</p>
</div>
<div class="paragraph">
<p>Multiple cloud providers are supported, see the list below for more information.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Supported</p>
<div class="ulist">
<ul>
<li>
<p>AWS S3 (<code>s3://</code>)</p>
</li>
<li>
<p>GCP Google Storage (<code>gs://</code>)</p>
</li>
<li>
<p>Azure Blob Storage in 7.1.2+ (<code>az://</code>)</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_required_2">Required</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">--obj-staging-dir &lt;staging_dir&gt;</dt>
<dd>
<p>When performing an operation on an archive which is located in the cloud such
as AWS, the staging directory is used to store local meta data files. This
directory can be temporary (it&#8217;s not treated as a persistent store) and is
only used during the backup. NOTE: Do not use <code>/tmp</code> as the <code>obj-staging-dir</code>.
See <code>Disk requirements</code> in <a href="cbbackupmgr-cloud.html">cbbackupmgr-cloud(7)</a> for more information.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_optional_2">Optional</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">--obj-access-key-id &lt;access_key_id&gt;</dt>
<dd>
<p>The access key id which has access to your chosen object store. This option
can be omitted when using the shared config functionality provided by your
chosen object store. Can alternatively be provided using the
<code>CB_OBJSTORE_ACCESS_KEY_ID</code> environment variable.</p>
<div class="paragraph">
<p>When using AWS, this option expects an access key id. See
<a href="https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys" class="bare">https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys</a>
for more information.</p>
</div>
<div class="paragraph">
<p>When using Azure, this option expects an account name. See
<a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-account-overview#storage-account-endpoints" class="bare">https://docs.microsoft.com/en-us/azure/storage/common/storage-account-overview#storage-account-endpoints</a>
for more information.</p>
</div>
<div class="paragraph">
<p>When using GCP, this option expects a client id. See
<a href="https://cloud.google.com/storage/docs/authentication" class="bare">https://cloud.google.com/storage/docs/authentication</a> for more information.</p>
</div>
</dd>
<dt class="hdlist1">--obj-cacert &lt;cert_path&gt;</dt>
<dd>
<p>Specifies a CA certificate that will be used to verify the identity of the
object store being connected to.</p>
</dd>
<dt class="hdlist1">--obj-endpoint &lt;endpoint&gt;</dt>
<dd>
<p>The host/address of your object store.</p>
</dd>
<dt class="hdlist1">--obj-read-only</dt>
<dd>
<p>Enable read only mode. When interacting with a cloud archive modifications
will be made e.g. a lockfile will be created, log rotation will take place
and the modified logs will be uploaded upon completion of the subcommand.
This flag disables these features should you wish to interact with an archive
in a container where you lack write permissions. This flag should be used
with caution and you should be aware that your logs will not be uploaded to
the cloud. This means that it&#8217;s important that if you encounter an error you
don&#8217;t remove you staging directory (since logs will still be created in there
and collected by the <code>collect-logs</code> subcommand).</p>
</dd>
<dt class="hdlist1">--obj-no-ssl-verify</dt>
<dd>
<p>Skips the SSL verification phase when connecting to the object store.
Specifying this flag will allow a connection using SSL encryption, but you
are vulnerable to a man-in-the-middle attack.</p>
</dd>
<dt class="hdlist1">--obj-region &lt;region&gt;</dt>
<dd>
<p>The region in which your bucket/container resides. For AWS this option may be
omitted when using the shared config functionality. See the AWS section of
the cloud documentation for more information.</p>
</dd>
<dt class="hdlist1">--obj-secret-access-key &lt;secret_access_key&gt;</dt>
<dd>
<p>The secret access key which has access to you chosen object store. This
option can be omitted when using the shared config functionality provided by
your chosen object store. Can alternatively be provided using the
<code>CB_OBJSTORE_SECRET_ACCESS_KEY</code> environment variable.</p>
<div class="paragraph">
<p>When using AWS, this option expects a secret access key. See
<a href="https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys" class="bare">https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys</a>
for more information.</p>
</div>
<div class="paragraph">
<p>When using Azure, this option expects an account key. See
<a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal" class="bare">https://docs.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal</a>
for more information.</p>
</div>
<div class="paragraph">
<p>When using GCP, this option expects a client secret. See
<a href="https://cloud.google.com/storage/docs/authentication" class="bare">https://cloud.google.com/storage/docs/authentication</a> for more information.</p>
</div>
</dd>
<dt class="hdlist1">--obj-log-level &lt;level&gt;</dt>
<dd>
<p>Set the log level for the cloud providers SDK. By default logging will be
disabled. Valid options are cloud provider specific and are listed below.</p>
<div class="paragraph">
<p>The valid options for the AWS SDK are <code>debug</code>, <code>debug-with-signing</code>,
<code>debug-with-body</code>, <code>debug-with-request-retries</code>, <code>debug-with-request-errors</code>,
and <code>debug-with-event-stream-body</code>.</p>
</div>
<div class="paragraph">
<p>The valid options for the Azure SDK are <code>info</code>, <code>debug</code>, <code>debug-with-request-retries</code> and
<code>debug-with-request-retries-and-lro</code>.</p>
</div>
<div class="paragraph">
<p>The Google Storage SDK does not expose advanced logging configuration meaning
this option is explicitly ignored, however, this behavior may change in the
future.</p>
</div>
</dd>
<dt class="hdlist1">--obj-auth-by-instance-metadata</dt>
<dd>
<p>Depending on the cloud provider, using instance metadata for authentication
is disabled by default. Supplying this flag will allow the fetching
credentials/auth tokens from (VM) internal instance metadata endpoints.</p>
<div class="paragraph">
<p>By default, this option is disabled for AWS.</p>
</div>
<div class="paragraph">
<p>By default, this option is enabled for Azure.</p>
</div>
<div class="paragraph">
<p>By default, this option is enabled for GCP.</p>
</div>
</dd>
<dt class="hdlist1">--obj-auth-file</dt>
<dd>
<p>GCP offers the ability to use a file which contains credentials which will be
used to perform authentication. The <code>--obj-auth-file</code> flag accepts a path to
an authentication file. This flag is unsupported for the AWS/Azure cloud
providers.</p>
</dd>
<dt class="hdlist1">--obj-refresh-token</dt>
<dd>
<p>GCP requires a refresh token when using static credentials, this will be used
to refresh oauth2 tokens when accessing remote storage.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_aws_s3_options">AWS S3 Options</h4>
<div class="sect4">
<h5 id="_optional_3">Optional</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">--s3-force-path-style</dt>
<dd>
<p>By default the updated virtual style paths will be used when interfacing with
AWS S3. This option will force the AWS SDK to use the alternative path style
URLs which are often required by S3 compatible object stores.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_encryption_developer_preview">Encryption (Developer Preview)</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">--passphrase &lt;passphrase&gt;</dt>
<dd>
<p>Passphrase can be used instead of an external key manager. This is not
supported on production and should only be used in development or testing.</p>
</dd>
<dt class="hdlist1">--km-key-url &lt;url&gt;</dt>
<dd>
<p>Provides the Key Identifier in the external Key Management system. Currently
supported KMSs are AWS KMS, GCP KMS, Azure KeyVault, HashiCorp Vault Transit
secrets engine. The option can also be provided using the environmental
variable <code>CB_KM_KEY_URL</code>. For more on how to authenticate using the different
providers see <a href="cbbackupmgr-encryption.html">cbbackupmgr-encryption(7)</a>.</p>
<div class="paragraph">
<p>For AWS the expected key format is <code>awskms://&lt;KEY-ID|KEY-ALIAS&gt;</code>, for example
<code>awskms://alias\keyAlias</code>.</p>
</div>
<div class="paragraph">
<p>For GCP the expected key format is <code>gcpkms://&lt;KEY-RESOURCE-ID&gt;</code>, for example
<code>gcpkms://projects/project-id/locations/location/keyRings/keyring/cryptoKeys/key</code>.</p>
</div>
<div class="paragraph">
<p>For Azure key vault the expected key format is <code>azurekeyvault://&lt;KEY-IDENTIFIER&gt;</code>
for example:
<code>azurekeyvault://vault-name.vault.azure.net/object-type/object-name/object-version</code>.</p>
</div>
<div class="paragraph">
<p>For HashiCorp Vault the expected format is <code>hashivaults://&lt;HOST&gt;/&lt;KEY-NAME&gt;</code>
for example:
<code>hashivaults://127.0.0.1:8200/keyName</code>.</p>
</div>
</dd>
<dt class="hdlist1">--km-region &lt;region&gt;</dt>
<dd>
<p>Required when using AWS KMS, it allows you to set the key region.</p>
</dd>
<dt class="hdlist1">--km-endpoint &lt;endpoint&gt;</dt>
<dd>
<p>The host or address to use as your KMS. It will override the default SDK one.</p>
</dd>
<dt class="hdlist1">--km-access-key-id &lt;id&gt;</dt>
<dd>
<p>The user ID used to connect to the key management service. It can also be
provided via <code>CB_KM_ACCESS_KEY_ID</code> environmental variable. Please refer
to <a href="cbbackupmgr-encryption.html">cbbackupmgr-encryption(7)</a> for the required authentication for each
provider.</p>
</dd>
<dt class="hdlist1">--km-secret-access-key &lt;key&gt;</dt>
<dd>
<p>The key used to connect to the key management service. It can also be
provided via the <code>CB_KM_SECRET_ACCESS_KEY</code> environmental variable. Please
refer to <a href="cbbackupmgr-encryption.html">cbbackupmgr-encryption(7)</a> for the required authentication for
each provider.</p>
</dd>
<dt class="hdlist1">--km-auth-file &lt;path&gt;</dt>
<dd>
<p>The path to a file containing the authentication credentials for the key
management service. It can also be provided via the <code>CB_KM_AUTH_FILE</code>
environmental variable. Please refer to <a href="cbbackupmgr-encryption.html">cbbackupmgr-encryption(7)</a> for the
required authentication for each provider.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_start_and_end">START AND END</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This sub-command accepts a <code>--start</code> and <code>--end</code> flag. These flags accept
multiple values to allow you to flexibly operate on a range of backups.</p>
</div>
<div class="sect2">
<h3 id="_indexes">Indexes</h3>
<div class="paragraph">
<p>Indexes may be supplied to operate on a range of backups, for example
<code>--start 1 --end 2</code> will include start at the first backup and will finish with
the second backup. Note that the first backup is 1 and not 0 and that the
<code>--end</code> flag is inclusive.</p>
</div>
</div>
<div class="sect2">
<h3 id="_short_dates">Short Dates</h3>
<div class="paragraph">
<p>Short dates may be supplied in the format <code>day-month-year</code>. For example
<code>--start 01-08-2020 --end 31-08-2020</code> will operate on all the backups which
were taken during August of 2020. Note that the end date is inclusive.</p>
</div>
<div class="paragraph">
<p>When supplying short dates, you may supply <code>start</code> or <code>oldest</code> as a placeholder
for the date on which the first backup in this repository was taken. The
keywords <code>end</code> or <code>latest</code> may be used as a placeholder for the date last
backup in the repository was taken.</p>
</div>
</div>
<div class="sect2">
<h3 id="_backup_names">Backup Names</h3>
<div class="paragraph">
<p>Backup names may be supplied as they exist on disk. For example
<code>--start 2020-08-13T20_01_08.894226137+01_00 --end 2020-08-13T20_01_12.348300092+01_00</code>
will cause the sub-command to operate on all the backups which inclusively fall
between these two backups.</p>
</div>
<div class="paragraph">
<p>When supplying backup names, you may supply <code>start</code> or <code>oldest</code> as a
placeholder for the first backup in the repository. The keywords <code>end</code> or
<code>latest</code> may be used  as a placeholder for the final backup in the repository.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_host_formats">HOST FORMATS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When specifying a host/cluster for a command using the <code>-c</code>/<code>--cluster</code> flag, the following formats
are accepted:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>http://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>https://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbase://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbases://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbase://&lt;srv&gt;</code></p>
</li>
<li>
<p><code>couchbases://&lt;srv&gt;</code></p>
</li>
<li>
<p><code>&lt;addr&gt;:&lt;port&gt;,&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>&lt;scheme&gt;://&lt;addr&gt;:&lt;port&gt;,&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>&lt;port&gt;</code> portion of the host format may be omitted, in which case the default port will be used
for the scheme provided. For example, <code>http://</code> and <code>couchbase://</code> will both default to 8091 where
<code>https://</code> and <code>couchbases://</code> will default to 18091. When connecting to a host/cluster using a
non-default port, the <code>&lt;port&gt;</code> portion of the host format must be specified.</p>
</div>
<div class="sect2">
<h3 id="_connection_strings_multiple_nodes">Connection Strings (Multiple nodes)</h3>
<div class="paragraph">
<p>The <code>-c</code>/<code>--cluster</code> flag accepts multiple nodes in the format of a connection string; this is a
comma separated list of <code>&lt;addr&gt;:&lt;port&gt;</code> strings where <code>&lt;scheme&gt;</code> only needs to be specified once.
The main advantage of supplying multiple hosts is that in the event of a failure, the next host in
the list will be used.</p>
</div>
<div class="paragraph">
<p>For example, all of the following are valid connection strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>localhost,[::1]</code></p>
</li>
<li>
<p><code>10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>http://10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2</code></p>
</li>
<li>
<p><code>couchbase://10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>couchbases://10.0.0.1:12345,10.0.0.2:12345</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_srv_records">SRV Records</h3>
<div class="paragraph">
<p>The <code>-c</code>/<code>--cluster</code> flag accepts DNS SRV records in place of a host/cluster address where the SRV
record will be resolved into a valid connection string. There are a couple of rules which must be
followed when supplying an SRV record which are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>&lt;scheme&gt;</code> portion must be either <code>couchbase://</code> or <code>couchbases://</code></p>
</li>
<li>
<p>The <code>&lt;srv&gt;</code> portion should be a hostname with no port</p>
</li>
<li>
<p>The <code>&lt;srv&gt;</code> portion must not be a valid IP address</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, all of the following are valid connection string using an SRV record:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>couchbase://hostname</code></p>
</li>
<li>
<p><code>couchbases://hostname</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_alternate_addressing_caok8s">Alternate Addressing (CAO/K8S)</h3>
<div class="paragraph">
<p>Users of the CAO (Couchbase Autonomous Operator) or K8S may need to supply the
<code>network=external</code> query parameter to force connection via the defined
alternate addressing.</p>
</div>
<div class="paragraph">
<p>For example, the following are valid connection strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2?network=default</code></p>
</li>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2?network=external</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_certificate_authentication_mtls_authentication">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tool supports authenticating against a Couchbase Cluster by using certificate based authentication (mTLS
authentication). To use certificate based authentication a certificate/key must be supplied, there a currently
multiple ways this may be done.</p>
</div>
<div class="sect2">
<h3 id="_pem_encoded_certificatekey">PEM ENCODED CERTIFICATE/KEY</h3>
<div class="paragraph">
<p>An unencrypted PEM encoded certificate/key may be supplied by using:
- <code>--client-cert &lt;path&gt;</code>
- <code>--client-key &lt;path&gt;</code></p>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate, and an optional chain required to authenticate
the client certificate.</p>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-key</code> must contain at most one private key, the key can be in one of the following formats:
- PKCS#1
- PKCS#8
- EC</p>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:
- RSA
- ECDSA
- ED25519</p>
</div>
</div>
<div class="sect2">
<h3 id="_pem_encoded_certificatepem_or_der_encrypted_pkcs8_key">PEM ENCODED CERTIFICATE/PEM OR DER ENCRYPTED PKCS#8 KEY</h3>
<div class="paragraph">
<p>An encrypted PKCS#8 formatted key may be provided using:
- <code>--client-cert &lt;path&gt;</code>
- <code>--client-key &lt;path&gt;</code>
- <code>--client-key-password &lt;password&gt;</code></p>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate, and an optional chain required to authenticate
the client certificate.</p>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:
- RSA
- ECDSA
- ED25519</p>
</div>
</div>
<div class="sect2">
<h3 id="_encrypted_pkcs12_certificatekey">ENCRYPTED PKCS#12 CERTIFICATE/KEY</h3>
<div class="paragraph">
<p>An encrypted PKCS#12 certificate/key may be provided using:
- <code>--client-cert &lt;path&gt;</code>
- <code>--client-cert-password &lt;password&gt;</code></p>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate and exactly one private key. It may also contain
the chain required to authenticate the client certificate.</p>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:
- RSA
- ECDSA
- ED25519</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rbac">RBAC</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When performing a backup/restore with a user which is using RBAC, there are a
couple of things that should be taken into consideration each of which is
highlighted in this section.</p>
</div>
<div class="sect2">
<h3 id="_bucket_level">Bucket Level</h3>
<div class="paragraph">
<p>Bucket level data may be backed up/restored using the <code>data_backup</code> (Data
Backup &amp; Restore) role.</p>
</div>
<div class="paragraph">
<p>The <code>data_backup</code> role does not have access to cluster level data such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Analytics Synonyms</p>
</li>
<li>
<p>Eventing Metadata</p>
</li>
<li>
<p>FTS Aliases</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Backing up/restoring cluster level data with the <code>data_backup</code> role will cause
permission errors like the one below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Error backing up cluster: {"message":"Forbidden. User needs one of the following permissions","permissions":["cluster.fts!read"]}</pre>
</div>
</div>
<div class="paragraph">
<p>When presented with an error message such as the one above, there&#8217;s two clear
options.</p>
</div>
<div class="paragraph">
<p>The first option is to provide the user with the required credentials using
either the cli, REST API or Couchbase Server WebUI. This can be done by editing
the user and adding the required role. See <code>Cluster Level</code> for more information
about the required roles.</p>
</div>
<div class="paragraph">
<p>Secondly, backing up/restoring the specific service can be disabled. For
backups this must be done when configuring the repository with the <code>config</code>
command using the <code>--disable</code> style flags. For restore, these flags may be used
directly to disable one or more services. See the backup/restore documentation
for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cluster_level">Cluster Level</h3>
<div class="paragraph">
<p>Backing up/restoring cluster level data requires additional RBAC roles, each of
which is highlighted below:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Analytics Synonyms</dt>
<dd>
<p><code>analytics_admin</code> (Analytics Admin)</p>
</dd>
<dt class="hdlist1">Eventing Metadata</dt>
<dd>
<p><code>eventing_admin</code> (Eventing Full Admin)</p>
</dd>
<dt class="hdlist1">FTS Aliases</dt>
<dd>
<p><code>fts_admin</code> (Search Admin)</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These additional roles are required since this is cluster level data which may
encompass multiple buckets.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supported_backup_versions">Supported Backup Versions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>restore</code> sub-command currently supports restoring backups created by all
previous versions of <code>cbbackupmgr</code>, however, this won&#8217;t always be the case.</p>
</div>
<div class="paragraph">
<p>The <code>ForestDB</code> storage format (used by <code>cbbackupmgr</code> versions prior to, but not
including 6.5.0) is now deprecated.</p>
</div>
<div class="paragraph">
<p>This means that future releases of <code>cbbackupmgr</code> will not be able to restore
backups created by versions of <code>cbbackupmgr</code> prior to but not including 6.5.0.</p>
</div>
<div class="paragraph">
<p>These backups are still safe and usable, however, they must be restored/merged
with a version of <code>cbbackupmgr</code> which supports interacting with 6.0.x archives
e.g. 6.5.x, 6.6.x, 7.0.x and 7.1.x.</p>
</div>
<div class="sect2">
<h3 id="_example">Example</h3>
<div class="paragraph">
<p>Imagine you have a backup created by a 6.0.x version of <code>cbbackupmgr</code>, this
will use the <code>ForestDB</code> storage format. You&#8217;d like to restore this backup,
however, the latest version no longer supports interacting with this format.</p>
</div>
<div class="paragraph">
<p>In this case, you could either:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Restore the backup using <code>cbbackupmgr</code> from 6.5.x, 6.6.x, 7.0.x or 7.1.x.</p>
</li>
<li>
<p>Merge two or more backups using <code>cbbackupmgr</code> from 6.5.x, 6.6.x, 7.0.x or 7.1.x then restore it using the latest version.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Although in this case you were unable to directly restore the backup with the
latest version of cbbackupmgr, the data is still indirectly accessible for
restore.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_replace_ttl">REPLACE TTL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The behavior of the --replace-ttl/--replace-ttl-with flags is well defined,
however, there are some conditions where the behavior may seem surprising or
unexpected due to conflict resolution.</p>
</div>
<div class="paragraph">
<p>Imagine the case where a backup contains one or more documents which have an
expiry which has now elapsed. There are several possible scenarios which could
take place when restoring these documents when using the <code>--replace-ttl</code> and
<code>--replace-ttl-with</code> flags. These scenarios are enumerated below.</p>
</div>
<div class="sect2">
<h3 id="_restoring_to_a_new_clusterbucket">RESTORING TO A NEW CLUSTER/BUCKET</h3>
<div class="paragraph">
<p>When restoring to a new cluster it&#8217;s expected that all the documents which match
the all/expired condition will be restored with their new/updated ttl values.</p>
</div>
</div>
<div class="sect2">
<h3 id="_restoring_to_the_same_bucket">RESTORING TO THE SAME BUCKET</h3>
<div class="paragraph">
<p>The most interesting/unexpected cases occur when restoring the backup to the
same bucket at some point in the future.</p>
</div>
<div class="sect3">
<h4 id="_expired_documents_have_not_been_purged">EXPIRED DOCUMENTS HAVE NOT BEEN PURGED</h4>
<div class="paragraph">
<p>In the event that the restore takes place and the expired documents have not
been purged yet, conflict resolution will take precedence and the documents will
not be restored. This behavior will manifest itself as skipped mutations which
will be displayed in restore sub-command output.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Restoring backup '2021-05-17T11_00_15.843794944+01_00'
Copied all data in 1.773s (Avg. 21.03MiB/Sec)                                                                           31591 items / 21.03MiB
[====================================================================================================================================] 100.00%

| Transfer
| --------
| Status    | Avg Transfer Rate | Started At                        | Finished At                     | Duration |
| Succeeded | 21.03MiB          | Mon, 17 May 2021 11:00:25 +0100/s | Mon, 17 May 2021 11:00:26 +0100 | 1.785s   |

| Bucket
| ------
| Name          | Status    | Transferred | Avg Transfer Rate | Started At                      | Finished At                     | Duration |
| travel-sample | Succeeded | 21.03MiB    | 21.03MiB/s        | Mon, 17 May 2021 11:00:25 +0100 | Mon, 17 May 2021 11:00:26 +0100 | 1.713s   |
|
| Mutations                    | Deletions                    | Expirations                  |
| ---------                    | ---------                    | -----------                  |
| Received | Errored | Skipped | Received | Errored | Skipped | Received | Errored | Skipped |
| 0        | 0       | 31591   | 0        | 0       | 0       | 0        | 0       | 0       |

Restore completed successfully</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_expired_documents_have_been_purged">EXPIRED DOCUMENTS HAVE BEEN PURGED</h4>
<div class="paragraph">
<p>If the restore is performed after the user-defined purge interval where a
compaction has taken place, the documents would be restored because the expired
documents would no longer exist in the cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_forcing_updates">FORCING UPDATES</h4>
<div class="paragraph">
<p>The above behavior may be overridden by using the <code>--force-updates</code> flag which
will bypass conflict resolution and result in the documents from the backup
being restored.</p>
</div>
<div class="paragraph">
<p>The <code>--force-updates</code> flag will affect all the documents being restored and not
just those which contain an expiry which is being replaced.  This may result in
documents being overwritten with older versions from the backup; if the expired
documents keys are known beforehand, a mixed use of <code>--force-updates</code> and
<code>--filter-keys</code> may be more precise.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples">EXAMPLES</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The restore command can be used to restore a single backup or range of backups
in a backup repository. In the examples below, we will look a few different ways
to restore data from a backup repository. All examples will assume that the
backup archive is located at /data/backups and that all backups are located in
the "example" backup repository.</p>
</div>
<div class="paragraph">
<p>The first thing to do when getting ready to restore data is to decide which
backups to restore. The easiest way to do this is to use the info command to see
which backups are available to restore.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cbbackupmgr info --archive /data/backups --repo example --all
Name     | Size    | # Backups  |
example  | 4.38MB  | 3          |

+  Backup                            | Size    | Type  | Source                 | Cluster UUID                      | Range  | Events  | Aliases  | Complete  |
+  2020-06-02T07_49_11.281004+01_00  | 1.69MB  | FULL  | http://localhost:8091  | c044f5eeb1dc16d0cd49dac29074b5f9  | N/A    | 0       | 1        | true      |

-    Bucket   | Size    | Items  | Mutations  | Tombstones  | Views  | FTS  | Indexes  | CBAS  |
-    example  | 1.69MB  | 4096   | 4096       | 0           | 0      | 0    | 0        | 0     |

+  Backup                            | Size    | Type  | Source                 | Cluster UUID                      | Range  | Events  | Aliases  | Complete  |
+  2020-06-03T07_49_52.577901+01_00  | 1.34MB  | INCR  | http://localhost:8091  | c044f5eeb1dc16d0cd49dac29074b5f9  | N/A    | 0       | 1        | true      |

-    Bucket   | Size    | Items  | Mutations  | Tombstones  | Views  | FTS  | Indexes  | CBAS  |
-    example  | 1.34MB  | 2048   | 2048       | 0           | 0      | 0    | 0        | 0     |

+  Backup                            | Size    | Type  | Source                 | Cluster UUID                      | Range  | Events  | Aliases  | Complete  |
+  2020-06-04T07_50_06.908787+01_00  | 1.34MB  | INCR  | http://localhost:8091  | c044f5eeb1dc16d0cd49dac29074b5f9  | N/A    | 0       | 1        | true      |

-    Bucket   | Size    | Items  | Mutations  | Tombstones  | Views  | FTS  | Indexes  | CBAS  |
-    example  | 1.34MB  | 2048   | 2048       | 0           | 0      | 0    | 0        | 0     |</pre>
</div>
</div>
<div class="paragraph">
<p>From the information of the backup repository we can see we have three backups
that we can restore in the "examples" backup repository. If we just want to
restore one of them we set the --start and --end flags in the restore command
to the same backup name and specify the cluster that we want to restore the data
to. In the example below we will restore only the oldest backup.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbbackupmgr restore -a /data/backups -r example \
 -c couchbase://127.0.0.1 -u Administrator -p password \
 --start 2020-06-02T07_49_11.281004+01_00 \
 --end 2020-06-02T07_49_11.281004+01_00</pre>
</div>
</div>
<div class="paragraph">
<p>If we want to restore only the two most recent backups then we specify the
--start and --end flags with different backup names in order to specify the
range we want to restore.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbbackupmgr restore -a /data/backups -r example \
 -c couchbase://127.0.0.1 -u Administrator -p password \
 --start 2020-06-02T07_49_11.281004+01_00 \
 --end 2020-06-03T07_49_52.577901+01_00</pre>
</div>
</div>
<div class="paragraph">
<p>If we want to restore all of the backups in the "examples" directory then we can
omit the --start and --end flags since their default values are the oldest and
most recent backup in the backup repository.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbbackupmgr restore -a /data/backups -r example \
 -c couchbase://127.0.0.1 -u Administrator -p password</pre>
</div>
</div>
<div class="paragraph">
<p>Restore also allows filtering the data restored by document key and/or value by passing
regular expressions to the flags <code>--filter-keys</code> and <code>--filter-values</code> respectively.
Say we backup the sample bucket 'beer-sample' if we only wanted to restore only the
documents that have a key that starts with '21st_amendment_brewery_cafe'. This can be
done using the flag <code>--filter-keys</code> as shown bellow.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cbbackupmg restore -c http://127.0.0.1:8091 -u Administrator -p password \
 -a /data/backups -r beer --filter-keys '^21st_amendment_brewery_cafe.*'</pre>
</div>
</div>
<div class="paragraph">
<p>Restore also allows filtering by value. Let&#8217;s say we only want to restore documents that
contain the JSON field <code>address</code>. This could be done by passing the regular expression
<code>{.*"address":.*}</code> to the <code>--filter-values</code> flag as illustrated below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cbbackupmgr -c http://127.0.0.1:8091 -u Administrator -p password \
 -a /data/backups -r beer --filter-values '{.*"address":.*}'</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, we can combine both flags to filter by both key and value. Imagine you want to
restore the values for beers that start with the key '21st_amendment_brewery_cafe' and
have the JSON field <code>"category":"North American Ale"</code>. This can be done by using
the command bellow.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cbbackupmgr -c http://127.0.0.1:8091 -u Administrator -p password \
 -a /data/backups -r beer --filter-values '{.*"category":"North American Ale".*}' \
 --filter-keys '^21st_amendment_brewery_cafe.*'</pre>
</div>
</div>
<div class="paragraph">
<p>The regular expressions provided must follow <a href="https://github.com/google/re2/wiki/Syntax">RE2 syntax</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_checksum_failure">CHECKSUM FAILURE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A checksum failure may occur during a restore and indicates that a document
has changed since the creation of the backup. Depending on the type of corruption
we may be able to restore by skipping only the corrupted documents. However, if the
size of the data file has changed (e.g. not a bit flip or byte for byte modification)
<strong>all</strong> documents after the corruption (for that vBucket) will be unusable.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automatic_collection_creation">AUTOMATIC COLLECTION CREATION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By design, users may not recreate the <code>_default</code> collection once it has been
deleted. Therefore, this means that the <code>_default</code> collection can&#8217;t (and won&#8217;t)
be recreated if it&#8217;s missing. Before performing a transfer, a check will take
place to see if the <code>_default</code> collection will be required when it&#8217;s missing.
If this is the case, the command will exit early and you will be required to
remap the <code>_default</code> collection using the <code>--map-data</code> flag.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automatic_collection_deletion">AUTOMATIC COLLECTION DELETION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During a backup cbbackupmgr will take note of which scopes/collections were
create/deleted/modified up to the point that the backup began.  This behavior
can be leveraged to automatically delete any scopes/collections which are
marked as deleted in the backup. We will only delete scopes/collections which
are identical to the ones which are stored in the backup; ones which match by
both id and name.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_remapping">REMAPPING</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During a transfer, scopes/collections can be remapped from one location to
another. There are several rules that are enforced when remapping
scopes/collections, they are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You must be running an Enterprise Edition version of Couchbase Server.</p>
</li>
<li>
<p>You may not remap the <code>_default</code> scope (discussed in THE DEFAULT SCOPE).</p>
</li>
<li>
<p>You may only remap scopes/collections at the same level meaning scopes may
be remapped to other scopes, and collections to other collections, however, a
scope can&#8217;t be remapped to a collection or vice versa.</p>
</li>
<li>
<p>Scopes/collections may only be remapped within the same bucket. For example
the mapping <code>bucket1.scope.collection=bucket2.scope.collection</code> is invalid.</p>
</li>
<li>
<p>Scopes/collections may only be remapped once. For example the mapping
<code>bucket1.scope1=bucket1.scope2,bucket1.scope1=bucket1.scope3</code> is invalid.</p>
</li>
<li>
<p>Remapping may only take place at one level at once meaning that if a parent
bucket/scope is already remapped, the child scopes/collections may not also
be remapped. For example the mapping
<code>bucket1.scope1=bucket1.scope2,bucket1.scope1.collection1=bucket1.scope3.collection9</code>
is invalid.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_remapping_a_scopecollection_without_renaming">REMAPPING A SCOPE/COLLECTION WITHOUT RENAMING</h3>
<div class="paragraph">
<p>During a transfer, it&#8217;s possible for a scope/collection to encounter a conflict
(for example, because it has been recreated). It may not be preferable to
rename the scope/collection during the transfer.</p>
</div>
<div class="paragraph">
<p>For this reason, the <code>--map-data</code> flag, allows you to remap a scope/collection
to itself; this indicates that the scope/collection that exists in the target
(with a different id) should be treated as the same.</p>
</div>
<div class="paragraph">
<p>As an example, the following error message indicates that a collection has been
recreated prior to a restore.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Error restoring cluster: collection 8 with name 'collection1' in the scope '_default' exists with a different name/id on the cluster, a manual remap is required</pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>--map-data</code> flag with the argument
<code>bucket._default.collection1=bucket._default.collection1</code> would cause
<code>cbbackupmgr</code> to treat <code>collection1</code> (with id 8) as <code>collection1</code> (with the id
it exists with in the target).</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_default_scope">THE DEFAULT SCOPE</h3>
<div class="paragraph">
<p>As mentioned in AUTOMATIC COLLECTION CREATION, it&#8217;s not possible to recreate
the <code>_default</code> scope/collection. This means you can&#8217;t remap the <code>_default</code>
scope because the tool may be unable to create a destination scope/collection.
This may be worked around by remapping each collection inside the <code>_default</code>
scope.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bucket_to_collection_remapping">BUCKET TO COLLECTION REMAPPING</h3>
<div class="paragraph">
<p>As discussed in REMAPPING, it&#8217;s not possible to remap data at different levels;
buckets must be remapped to buckets, scopes to scopes and collections to
collections. However, there is one supported edge case, which is remapping a
bucket into a collection to allow migration from a collection unaware to
collection aware datasets.</p>
</div>
<div class="paragraph">
<p>To remap a bucket into a collection using <code>--map-data</code> you may supply
<code>--map-data bucket._default._default=bucket.scope.collection</code>. This
functionality is compatible with cross bucket mapping, for example you may also
supply <code>--map-data bucket1._default._default=bucket2.scope.collection</code>.</p>
</div>
<div class="paragraph">
<p>Note that once you&#8217;ve provided a mapping to remap a bucket into a collection
you may not remap that bucket elsewhere. For example <code>--map-data
bucket1._default._default=bucket2.scope.collection,bucket1=bucket3</code> is invalid.</p>
</div>
</div>
<div class="sect2">
<h3 id="_remapping_multiple_data_sources_into_a_single_target_source">REMAPPING MULTIPLE DATA SOURCES INTO A SINGLE TARGET SOURCE</h3>
<div class="paragraph">
<p>As outlined in the rules discussed in REMAPPING, it&#8217;s not possible to remap a
bucket/scope/collection multiple times, however, it is possible to remap to a
single destination multiple times. For example the mapping
<code>bucket1=dest,bucket2=dest,bucket3=dest</code> is valid.</p>
</div>
<div class="paragraph">
<p>Although valid, this manor of remapping is dangerous and can result in data not
being transferred due to conflicting key spaces. If this style of remapping is
detected a warning will be printed before proceeding.
:!supports_automatic_collection_deletion:</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_restoring_a_collection_aware_backup_to_a_collection_unaware_cluster">RESTORING A COLLECTION AWARE BACKUP TO A COLLECTION UNAWARE CLUSTER</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The restore sub-command supports restoring collection aware backups to
collection unaware cluster. When restoring a collection aware backup to a
cluster which doesn&#8217;t support collections, <code>cbbackupmgr</code> will restore the
<code>_default._default</code> collection into the target bucket; no data will be
transferred for any other collections.</p>
</div>
<div class="paragraph">
<p>This allows you to utilize a collection aware cluster, without using the
collections feature and still be able to restore your data to a cluster which
is running a previous version of Couchbase which is collection unaware.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_discussion">DISCUSSION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The restore command works by replaying the data recorded in backup files. During
a restore each key-value pair backed up by cbbackupmgr will be sent to the
cluster as either a "set" or "delete" operation. The restore command replays
data from each file in order of backup time to guarantee that older backup data
does not overwrite newer backup data. The restore command uses Couchbase&#8217;s
conflict resolution mechanism by default to ensure this behavior. The conflict
resolution mechanism can be disable by specifying the --force-updates flag when
executing a restore.</p>
</div>
<div class="paragraph">
<p>Starting in Couchbase 4.6 each bucket can have different conflict resolution
mechanisms. cbbackupmgr will backup all meta data used for conflict resolution,
but since each conflict resolution mechanism is different cbbackupmgr will
prevent restores to a bucket when the source and destination conflict resolution
methods differ. This is done because by default cbbackupmgr will use the
conflict resolution mechanism of the destination bucket to ensure an older value
does not overwrite a newer value. If you want to restore a backup to a bucket
with a different conflict resolution type you can do by using the
--force-updates flag. This is allowed because forcing updates means that
cbbackupmgr will skip doing conflict resolution on the destination bucket.</p>
</div>
<div class="paragraph">
<p>Also keep in mind that unlike backups, restores cannot be resumed if they fail.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_environment_and_configuration_variables">ENVIRONMENT AND CONFIGURATION VARIABLES</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">CB_CLUSTER</dt>
<dd>
<p>Specifies the hostname of the Couchbase cluster to connect to. If the
hostname is supplied as a command line argument then this value is
overridden.</p>
</dd>
<dt class="hdlist1">CB_USERNAME</dt>
<dd>
<p>Specifies the username for authentication to a Couchbase cluster. If the
username is supplied as a command line argument then this value is
overridden.</p>
</dd>
<dt class="hdlist1">CB_PASSWORD</dt>
<dd>
<p>Specifies the password for authentication to a Couchbase cluster. If the
password is supplied as a command line argument then this value is
overridden.</p>
</dd>
<dt class="hdlist1">CB_CLIENT_CERT</dt>
<dd>
<p>The path to a client certificate used to authenticate when connecting to a
cluster. May be supplied with <code>CB_CLIENT_KEY</code> as an alternative to the
<code>CB_USERNAME</code> and <code>CB_PASSWORD</code> variables. See the CERTIFICATE AUTHENTICATION
section for more information.</p>
</dd>
<dt class="hdlist1">CB_CLIENT_CERT_PASSWORD</dt>
<dd>
<p>The password for the certificate provided to the <code>CB_CLIENT_CERT</code> variable,
when using this variable, the certificate/key pair is expected to be in the
PKCS#12 format. See the CERTIFICATE AUTHENTICATION section for more
information.</p>
</dd>
<dt class="hdlist1">CB_CLIENT_KEY</dt>
<dd>
<p>The path to the client private key whose public key is contained in the
certificate provided to the <code>CB_CLIENT_CERT</code> variable. May be supplied with
<code>CB_CLIENT_CERT</code> as an alternative to the <code>CB_USERNAME</code> and <code>CB_PASSWORD</code>
variables. See the CERTIFICATE AUTHENTICATION section for more information.</p>
</dd>
<dt class="hdlist1">CB_CLIENT_KEY_PASSWORD</dt>
<dd>
<p>The password for the key provided to the <code>CB_CLIENT_KEY</code> variable, when using
this variable, the key is expected to be in the PKCS#8 format.  See the
CERTIFICATE AUTHENTICATION section for more information.</p>
</dd>
<dt class="hdlist1">CB_ARCHIVE_PATH</dt>
<dd>
<p>Specifies the path to the backup archive. If the archive path is supplied as
a command line argument then this value is overridden.</p>
</dd>
<dt class="hdlist1">CB_OBJSTORE_STAGING_DIRECTORY</dt>
<dd>
<p>Specifies the path to the staging directory. If the <code>--obj-staging-dir</code>
argument is provided in the command line then this value is overridden.</p>
</dd>
<dt class="hdlist1">CB_OBJSTORE_REGION</dt>
<dd>
<p>Specifies the object store region. If the <code>--obj-region</code> argument is provided
in the command line then this value is overridden.</p>
</dd>
<dt class="hdlist1">CB_OBJSTORE_ACCESS_KEY_ID</dt>
<dd>
<p>Specifies the object store access key id. If the <code>--obj-access-key-id</code>
argument is provided in the command line this value is overridden.</p>
</dd>
<dt class="hdlist1">CB_OBJSTORE_SECRET_ACCESS_KEY</dt>
<dd>
<p>Specifies the object store secret access key. If the
<code>--obj-secret-access-key</code> argument is provided in the command line this value
is overridden.</p>
</dd>
<dt class="hdlist1">CB_OBJSTORE_REFRESH_TOKEN</dt>
<dd>
<p>Specifies the refresh token to use. If the <code>--obj-refresh-token</code> argument is
provided in the command line, this value is overridden.</p>
</dd>
<dt class="hdlist1">CB_AWS_ENABLE_EC2_METADATA</dt>
<dd>
<p>By default cbbackupmgr will disable fetching EC2 instance metadata. Setting
this environment variable to true will allow the AWS SDK to fetch metadata
from the EC2 instance endpoint.</p>
</dd>
<dt class="hdlist1">CB_ENCRYPTION_PASSPHRASE</dt>
<dd>
<p>Specifies the passphrase used for encryption.</p>
</dd>
<dt class="hdlist1">CB_KM_KEY_URL</dt>
<dd>
<p>Specifies the URL identifying the encryption key on the KMS. See
<code>--km-key-url</code> for the expected format and accepted KMSs.</p>
</dd>
<dt class="hdlist1">CB_KM_ACCESS_ID</dt>
<dd>
<p>Specifies the key/user ID used to connect to the KMS.</p>
</dd>
<dt class="hdlist1">CB_KM_SECRET_ACCESS_KEY</dt>
<dd>
<p>Specifies the secret key/token used to connect to the KMS.</p>
</dd>
<dt class="hdlist1">CB_KM_AUTH_FILE</dt>
<dd>
<p>Specifies a path to a file containing the required credentials to connect to
the KMS.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">SEE ALSO</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="cbbackupmgr-backup.html">cbbackupmgr-backup(1)</a>,
<a href="cbbackupmgr-info.html">cbbackupmgr-info(1)</a>,
<a href="cbbackupmgr-cloud.html">cbbackupmgr-cloud(7)</a>
<a href="cbbackupmgr-network-filesystems.html">cbbackupmgr-network-filesystems(7)</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cbbackupmgr">CBBACKUPMGR</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the <a href="cbbackupmgr.html">cbbackupmgr(1)</a> suite</p>
</div>
</div>
</div>
</div>
</body>
</html>