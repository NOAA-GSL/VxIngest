'\" t
.\"     Title: cbbackupmgr-examine
.\"    Author: Couchbase
.\" Generator: Asciidoctor 2.0.16
.\"      Date: 2023-09-20
.\"    Manual: Couchbase Server Manual
.\"    Source: Couchbase Server 7.2.2-6401
.\"  Language: English
.\"
.TH "CBBACKUPMGR\-EXAMINE" "1" "2023-09-20" "Couchbase Server 7.2.2\-6401" "Couchbase Server Manual"
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.ss \n[.ss] 0
.nh
.ad l
.de URL
\fI\\$2\fP <\\$1>\\$3
..
.als MTO URL
.if \n[.g] \{\
.  mso www.tmac
.  am URL
.    ad l
.  .
.  am MTO
.    ad l
.  .
.  LINKSTYLE blue R < >
.\}
.SH "NAME"
cbbackupmgr-examine \- Searches one or more backups by key for a specific document
.SH "SYNOPSIS"
.sp
.nf
cbbackupmgr examine [\-\-archive <archive_dir>] [\-\-repo <repo_name>]
                    [\-\-collection\-string <collection_string>] [\-\-key <key>]
                    [\-\-start start] [\-\-end end] [\-\-search\-partial\-backups]
                    [\-\-json] [\-\-no\-meta] [\-\-no\-xattrs] [\-\-no\-value]
                    [\-\-hex\-meta] [\-\-hex\-xattrs] [\-\-hex\-value]
                    [\-\-obj\-access\-key\-id <access_key_id>]
                    [\-\-obj\-cacert <cert_path>] [\-\-obj\-endpoint <endpoint>]
                    [\-\-obj\-no\-ssl\-verify] [\-\-obj\-region <region>]
                    [\-\-obj\-staging\-dir <staging_dir>]
                    [\-\-obj\-secret\-access\-key <secret_access_key>]
                    [\-\-s3\-force\-path\-style] [\-\-s3\-log\-level <level>]
                    [\-\-passphrase <passphrase>] [\-\-km\-key\-url <url>]
                    [\-\-km\-endpoint <endpoint>] [\-\-km\-region <region>]
                    [\-\-km\-access\-key\-id <id>] [\-\-km\-secret\-access\-key <key>]
                    [\-\-km\-auth\-file <path>] [\-\-point\-in\-time <time>]
.fi
.br
.SH "DESCRIPTION"
.sp
Examine is an Enterprise Edition command used to find information about a given
key. Examine will produce a timeline highlighting events related to the key
during the backups e.g. first appearance, mutation and deletion.
.sp
You may optionally use the \f(CR\-\-start\fP and \f(CR\-\-end\fP flags to limit the range of
backups for which an event timeline is produced. See START AND END for more
information.
.sp
Examine also supports outputting the event timeline in multiple formats,
including being able to hexdump/include/omit portions of a document.
.SH "OPTIONS"
.sp
Below is a list of parameters for the examine command.
.SS "Required"
.sp
\-a,\-\-archive <archive_dir>
.RS 4
The archive directory to examine. When using examine against an archive stored
in S3 prefix the archive path with \f(CRs3://${BUCKET_NAME}/\fP
.RE
.sp
\-r,\-\-repository <repo_name>
.RS 4
The name of the backup repository to examine.
.RE
.sp
\-\-collection\-string <collection_string>
.RS 4
A dot separated collection string representing the bucket/collection which
contains the key you are trying to examine. When interacting with a
collection unaware backup the collection string must only contain a bucket
e.g. \f(CR\-\-collection\-string default\fP. When interacting with a collection aware
backup the collection string must contain the path to a collection e.g.
\f(CR\-\-collection\-string default.scope.collection\fP. Note that you may omit the
scope/collection for collection aware backups which only contain the
\f(CR_default\fP scope and collection e.g. \f(CR\-\-collection\-string default\fP is
internally translated to \f(CR\-\-collection\-string default._default._default\fP. For
more information see \f(CRCOLLECTION AWARE BACKUPS\fP in \fBcbbackupmgr\-backup\fP(1).
.RE
.sp
\-k,\-\-key
.RS 4
The name of the key you are trying to find.
.RE
.SS "Optional"
.sp
\-\-start <start>
.RS 4
The first backup to examine. See START AND END for information on what values
are accepted.
.RE
.sp
\-\-end <end>
.RS 4
The final backup to examine. See START AND END for information on what values
are accepted.
.RE
.sp
\-\-search\-partial\-backups
.RS 4
By default examine will skip backups which are incomplete. This flag may be
supplied to attempt to search incomplete backups, however, the resulting
search may fail, or not find the key you\(cqre looking for.
.RE
.sp
\-j,\-\-json
.RS 4
Return any output as a JSON structure.
.RE
.sp
\-\-no\-meta
.RS 4
Do not return any of the documents metadata. Mutually exclusive with the
\f(CR\-\-hex\-meta\fP flag.
.RE
.sp
\-\-no\-xattrs
.RS 4
Do not return any of the documents extended attributes. Mutually exclusive
with the \f(CR\-\-hex\-xattrs\fP flag.
.RE
.sp
\-\-no\-value
.RS 4
Do not return the documents value. Mutually exclusive with the \f(CR\-\-hex\-value\fP
flag.
.RE
.sp
\-\-hex\-meta
.RS 4
Return the metadata encoded in hex. Mutually exclusive with the \f(CR\-\-no\-meta\fP
flag.
.RE
.sp
\-\-hex\-xattrs
.RS 4
Return the extended attributes encoded in hex. Mutually exclusive with the
\f(CR\-\-no\-xattrs\fP flag.
.RE
.sp
\-\-hex\-value
.RS 4
Return the value encoded in hex. Mutually exclusive with the \f(CR\-\-no\-value\fP
flag.
.RE
.sp
\-\-point\-in\-time <time>
.RS 4
(Beta) Only examine documents up to the given point in time. The value
accepted is ISO8601 date time format (YYYY\-MM\-DDTHH:MM:SS). This feature is
currently in Beta and is not supported, this should only be used in test
environments.
.RE
.SS "Cloud integration"
.sp
Native cloud integration is an Enterprise Edition feature which was introduced
in Couchbase Server 6.6.0.
.sp
Multiple cloud providers are supported, see the list below for more information.
.sp
.RS 4
.ie n \{\
\h'-04' 1.\h'+01'\c
.\}
.el \{\
.  sp -1
.  IP " 1." 4.2
.\}
Supported
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.  sp -1
.  IP \(bu 2.3
.\}
AWS S3 (\f(CRs3://\fP)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.  sp -1
.  IP \(bu 2.3
.\}
GCP Google Storage (\f(CRgs://\fP)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.  sp -1
.  IP \(bu 2.3
.\}
Azure Blob Storage in 7.1.2+ (\f(CRaz://\fP)
.RE
.RE
.SS "Required"
.sp
\-\-obj\-staging\-dir <staging_dir>
.RS 4
When performing an operation on an archive which is located in the cloud such
as AWS, the staging directory is used to store local meta data files. This
directory can be temporary (it\(cqs not treated as a persistent store) and is
only used during the backup. NOTE: Do not use \f(CR/tmp\fP as the \f(CRobj\-staging\-dir\fP.
See \f(CRDisk requirements\fP in \fBcbbackupmgr\-cloud\fP(7) for more information.
.RE
.SS "Optional"
.sp
\-\-obj\-access\-key\-id <access_key_id>
.RS 4
The access key id which has access to your chosen object store. This option
can be omitted when using the shared config functionality provided by your
chosen object store. Can alternatively be provided using the
\f(CRCB_OBJSTORE_ACCESS_KEY_ID\fP environment variable.
.sp
When using AWS, this option expects an access key id. See
\c
.URL "https://docs.aws.amazon.com/general/latest/gr/aws\-sec\-cred\-types.html#access\-keys\-and\-secret\-access\-keys" ""
for more information.
.sp
When using Azure, this option expects an account name. See
\c
.URL "https://docs.microsoft.com/en\-us/azure/storage/common/storage\-account\-overview#storage\-account\-endpoints" ""
for more information.
.sp
When using GCP, this option expects a client id. See
.URL "https://cloud.google.com/storage/docs/authentication" "" ""
for more information.
.RE
.sp
\-\-obj\-cacert <cert_path>
.RS 4
Specifies a CA certificate that will be used to verify the identity of the
object store being connected to.
.RE
.sp
\-\-obj\-endpoint <endpoint>
.RS 4
The host/address of your object store.
.RE
.sp
\-\-obj\-no\-ssl\-verify
.RS 4
Skips the SSL verification phase when connecting to the object store.
Specifying this flag will allow a connection using SSL encryption, but you
are vulnerable to a man\-in\-the\-middle attack.
.RE
.sp
\-\-obj\-region <region>
.RS 4
The region in which your bucket/container resides. For AWS this option may be
omitted when using the shared config functionality. See the AWS section of
the cloud documentation for more information.
.RE
.sp
\-\-obj\-secret\-access\-key <secret_access_key>
.RS 4
The secret access key which has access to you chosen object store. This
option can be omitted when using the shared config functionality provided by
your chosen object store. Can alternatively be provided using the
\f(CRCB_OBJSTORE_SECRET_ACCESS_KEY\fP environment variable.
.sp
When using AWS, this option expects a secret access key. See
\c
.URL "https://docs.aws.amazon.com/general/latest/gr/aws\-sec\-cred\-types.html#access\-keys\-and\-secret\-access\-keys" ""
for more information.
.sp
When using Azure, this option expects an account key. See
\c
.URL "https://docs.microsoft.com/en\-us/azure/storage/common/storage\-account\-keys\-manage?tabs=azure\-portal" ""
for more information.
.sp
When using GCP, this option expects a client secret. See
.URL "https://cloud.google.com/storage/docs/authentication" "" ""
for more information.
.RE
.sp
\-\-obj\-log\-level <level>
.RS 4
Set the log level for the cloud providers SDK. By default logging will be
disabled. Valid options are cloud provider specific and are listed below.
.sp
The valid options for the AWS SDK are \f(CRdebug\fP, \f(CRdebug\-with\-signing\fP,
\f(CRdebug\-with\-body\fP, \f(CRdebug\-with\-request\-retries\fP, \f(CRdebug\-with\-request\-errors\fP,
and \f(CRdebug\-with\-event\-stream\-body\fP.
.sp
The valid options for the Azure SDK are \f(CRinfo\fP, \f(CRdebug\fP, \f(CRdebug\-with\-request\-retries\fP and
\f(CRdebug\-with\-request\-retries\-and\-lro\fP.
.sp
The Google Storage SDK does not expose advanced logging configuration meaning
this option is explicitly ignored, however, this behavior may change in the
future.
.RE
.sp
\-\-obj\-auth\-by\-instance\-metadata
.RS 4
Depending on the cloud provider, using instance metadata for authentication
is disabled by default. Supplying this flag will allow the fetching
credentials/auth tokens from (VM) internal instance metadata endpoints.
.sp
By default, this option is disabled for AWS.
.sp
By default, this option is enabled for Azure.
.sp
By default, this option is enabled for GCP.
.RE
.sp
\-\-obj\-auth\-file
.RS 4
GCP offers the ability to use a file which contains credentials which will be
used to perform authentication. The \f(CR\-\-obj\-auth\-file\fP flag accepts a path to
an authentication file. This flag is unsupported for the AWS/Azure cloud
providers.
.RE
.sp
\-\-obj\-refresh\-token
.RS 4
GCP requires a refresh token when using static credentials, this will be used
to refresh oauth2 tokens when accessing remote storage.
.RE
.SS "AWS S3 Options"
.SS "Optional"
.sp
\-\-s3\-force\-path\-style
.RS 4
By default the updated virtual style paths will be used when interfacing with
AWS S3. This option will force the AWS SDK to use the alternative path style
URLs which are often required by S3 compatible object stores.
.RE
.SS "Encryption (Developer Preview)"
.sp
\-\-passphrase <passphrase>
.RS 4
Passphrase can be used instead of an external key manager. This is not
supported on production and should only be used in development or testing.
.RE
.sp
\-\-km\-key\-url <url>
.RS 4
Provides the Key Identifier in the external Key Management system. Currently
supported KMSs are AWS KMS, GCP KMS, Azure KeyVault, HashiCorp Vault Transit
secrets engine. The option can also be provided using the environmental
variable \f(CRCB_KM_KEY_URL\fP. For more on how to authenticate using the different
providers see \fBcbbackupmgr\-encryption\fP(7).
.sp
For AWS the expected key format is \f(CRawskms://<KEY\-ID|KEY\-ALIAS>\fP, for example
\f(CRawskms://alias\(rskeyAlias\fP.
.sp
For GCP the expected key format is \f(CRgcpkms://<KEY\-RESOURCE\-ID>\fP, for example
\f(CRgcpkms://projects/project\-id/locations/location/keyRings/keyring/cryptoKeys/key\fP.
.sp
For Azure key vault the expected key format is \f(CRazurekeyvault://<KEY\-IDENTIFIER>\fP
for example:
\f(CRazurekeyvault://vault\-name.vault.azure.net/object\-type/object\-name/object\-version\fP.
.sp
For HashiCorp Vault the expected format is \f(CRhashivaults://<HOST>/<KEY\-NAME>\fP
for example:
\f(CRhashivaults://127.0.0.1:8200/keyName\fP.
.RE
.sp
\-\-km\-region <region>
.RS 4
Required when using AWS KMS, it allows you to set the key region.
.RE
.sp
\-\-km\-endpoint <endpoint>
.RS 4
The host or address to use as your KMS. It will override the default SDK one.
.RE
.sp
\-\-km\-access\-key\-id <id>
.RS 4
The user ID used to connect to the key management service. It can also be
provided via \f(CRCB_KM_ACCESS_KEY_ID\fP environmental variable. Please refer
to \fBcbbackupmgr\-encryption\fP(7) for the required authentication for each
provider.
.RE
.sp
\-\-km\-secret\-access\-key <key>
.RS 4
The key used to connect to the key management service. It can also be
provided via the \f(CRCB_KM_SECRET_ACCESS_KEY\fP environmental variable. Please
refer to \fBcbbackupmgr\-encryption\fP(7) for the required authentication for
each provider.
.RE
.sp
\-\-km\-auth\-file <path>
.RS 4
The path to a file containing the authentication credentials for the key
management service. It can also be provided via the \f(CRCB_KM_AUTH_FILE\fP
environmental variable. Please refer to \fBcbbackupmgr\-encryption\fP(7) for the
required authentication for each provider.
.RE
.SH "START AND END"
.sp
This sub\-command accepts a \f(CR\-\-start\fP and \f(CR\-\-end\fP flag. These flags accept
multiple values to allow you to flexibly operate on a range of backups.
.SS "Indexes"
.sp
Indexes may be supplied to operate on a range of backups, for example
\f(CR\-\-start 1 \-\-end 2\fP will include start at the first backup and will finish with
the second backup. Note that the first backup is 1 and not 0 and that the
\f(CR\-\-end\fP flag is inclusive.
.SS "Short Dates"
.sp
Short dates may be supplied in the format \f(CRday\-month\-year\fP. For example
\f(CR\-\-start 01\-08\-2020 \-\-end 31\-08\-2020\fP will operate on all the backups which
were taken during August of 2020. Note that the end date is inclusive.
.sp
When supplying short dates, you may supply \f(CRstart\fP or \f(CRoldest\fP as a placeholder
for the date on which the first backup in this repository was taken. The
keywords \f(CRend\fP or \f(CRlatest\fP may be used as a placeholder for the date last
backup in the repository was taken.
.SS "Backup Names"
.sp
Backup names may be supplied as they exist on disk. For example
\f(CR\-\-start 2020\-08\-13T20_01_08.894226137+01_00 \-\-end 2020\-08\-13T20_01_12.348300092+01_00\fP
will cause the sub\-command to operate on all the backups which inclusively fall
between these two backups.
.sp
When supplying backup names, you may supply \f(CRstart\fP or \f(CRoldest\fP as a
placeholder for the first backup in the repository. The keywords \f(CRend\fP or
\f(CRlatest\fP may be used  as a placeholder for the final backup in the repository.
.SH "SEARCH SPACE"
.sp
The examine command supports searching though multiple backups, this section
explains how to use examine to search multiple backups and how it behaves when
a repository contains backups from an older version or mixed collection
aware/unaware backups.
.SS "BACKUPS FROM OLDER VERSIONS OF CBBACKUPMGR"
.sp
The examine command only supports searching backups created using a version of
cbbackupmgr greater than or equal to 6.5.0.
.sp
When examine encounters a range of backups where no backups can be searched an
error will be returned to you.
.sp
When examine encounters a mixed range of backups where one or more backups can
be searched examine will skip the old backups and only search the supported
backups. Note that a warning will be displayed indicating how many backups were
skipped.
.SS "SEARCHING COLLECTION AWARE/UNAWARE BACKUPS"
.sp
When searching a collection unaware backup, the \f(CR\-\-collection\-string\fP argument
expects only a bucket and will throw an error if provided with a scope or
collection.
.sp
When searching a collection aware backup, the \f(CR\-\-collection\-string\fP argument
expects a collection in the format \f(CRbucket.scope.collection\fP and will throw an
error if provided with a bucket or scope.
.sp
See the EXAMPLES section for examples of examining collection aware/unaware
backups.
.SS "SEARCHING MIXED COLLECTION AWARE/UNAWARE BACKUPS"
.sp
When examining a range of backups which transition from collection unaware to
collection aware (for example after upgrading the target cluster to 7.0.0)
examine will stop search upon hitting the first collection aware backup.
.sp
Examine will print a warning indicating that it stopped searching prematurely,
this warning will contain the name of the backup which can be passed into the
\f(CR\-\-start\fP flag to allow you to examine only the collection aware backups.
.sp
.if n .RS 4
.nf
.fam C
$ cbbackupmgr examine \-a $PWD/archive \-r repo \-\-collection\-string \*(Aqtravel\-sample\*(Aq \-\-key \*(Aqairline_10\*(Aq
Warning: Finished examining collection unaware backups, 1 collection aware backup(s) remain(s); use the \-\-start/\-\-end flags to examine the collection aware backup(s) starting at \*(Aq2021\-01\-27T13_35_53.284474589Z\*(Aq
\-\- Backup 2021\-01\-27T13_33_08.986105547Z \-\-
Description: First occurrence of key \*(Aqairline_10\*(Aq in this timeline, document created
Cluster UUID: 59845c6cdce57b81bd6f450e5043bee7
Bucket: travel\-sample (61ca19c7819478f27e03b398c6a540e7)
Document:
  Key: airline_10
  Sequence Number: 1
  Deleted: false
  Size: 159B (Key: 10B) (Meta: 29B) (Value: 120B) (XATTRS: 0B)
  Meta:
    Flags: 33554432
    Expiry: 0
    Locktime: 0
    CAS: 1611754171980709888
    Revseqno: 1
    Datatype: 3 (snappy,json)
  Value:
    {
        "callsign": "MILE\-AIR",
        "country": "United States",
        "iata": "Q5",
        "icao": "MLA",
        "id": 10,
        "name": "40\-Mile Air",
        "type": "airline"
    }
.fam
.fi
.if n .RE
.SH "EXAMPLES"
.sp
The examine command can be used to determine whether a collection unaware backup
contains a specific document. See \f(CRCOLLECTION AWARE BACKUPS\fP in
\fBcbbackupmgr\-backup\fP(1) for information on what makes a backup collection
aware/unaware.
.sp
.if n .RS 4
.nf
.fam C
$ cbbackupmgr examine \-a $PWD/archive \-r repo \-\-collection\-string \*(Aqtravel\-sample\*(Aq \-\-key \*(Aqairline_10\*(Aq
\-\- Backup 2021\-01\-27T12_36_59.013718359Z \-\-
Description: First occurrence of key \*(Aqairline_10\*(Aq in this timeline, document created
Cluster UUID: d22cb6cbb72f9d6a86b75317478f60b0
Bucket: travel\-sample (2de1c5edcd2daca4a08360c130ea6b19)
Document:
  Key: airline_10
  Sequence Number: 1
  Deleted: false
  Size: 159B (Key: 10B) (Meta: 29B) (Value: 120B) (XATTRS: 0B)
  Meta:
    Flags: 33554432
    Expiry: 0
    Locktime: 0
    CAS: 1611750671350693888
    Revseqno: 1
    Datatype: 3 (snappy,json)
  Value:
    {
        "id": 10,
        "type": "airline",
        "name": "40\-Mile Air",
        "iata": "Q5",
        "icao": "MLA",
        "callsign": "MILE\-AIR",
        "country": "United States"
    }
.fam
.fi
.if n .RE
.sp
The same principle applies when searching a collection aware backup, the only
difference being that the \f(CR\-\-collection\-string\fP argument requires a collection.
.sp
.if n .RS 4
.nf
.fam C
$ cbbackupmgr examine \-a $PWD/archive \-r repo \-\-collection\-string \*(Aqtravel\-sample.inventory.airline\*(Aq \-\-key \*(Aqairline_10\*(Aq
\-\- Backup 2021\-01\-27T12_38_21.55739452Z \-\-
Description: First occurrence of key \*(Aqairline_10\*(Aq in this timeline, document created
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
Bucket: travel\-sample (13c11d3be4bfba95f9e4da73bf8d1960)
Scope: inventory (8)
Collection: airline (10)
Document:
  Key: airline_10
  Sequence Number: 44
  Deleted: false
  Size: 159B (Key: 10B) (Meta: 29B) (Value: 120B) (XATTRS: 0B)
  Meta:
    Flags: 0
    Expiry: 0
    Locktime: 0
    CAS: 1611751097702088704
    Revseqno: 1
    Datatype: 3 (snappy,json)
  Value:
    {
        "id": 10,
        "type": "airline",
        "name": "40\-Mile Air",
        "iata": "Q5",
        "icao": "MLA",
        "callsign": "MILE\-AIR",
        "country": "United States"
    }
.fam
.fi
.if n .RE
.sp
When more than one backup exists in a repository, examine will continue
searching and output information for each backup it searches.
.sp
.if n .RS 4
.nf
.fam C
$ cbbackupmgr examine \-a ~/Projects/couchbase\-archive \-r repo \-\-collection\-string \*(Aqtravel\-sample.inventory.airline\*(Aq \-\-key \*(Aqairline_10\*(Aq
\-\- Backup 2021\-01\-27T12_38_21.55739452Z \-\-
Description: First occurrence of key \*(Aqairline_10\*(Aq in this timeline, document created
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
Bucket: travel\-sample (13c11d3be4bfba95f9e4da73bf8d1960)
Scope: inventory (8)
Collection: airline (10)
Document:
  Key: airline_10
  Sequence Number: 44
  Deleted: false
  Size: 159B (Key: 10B) (Meta: 29B) (Value: 120B) (XATTRS: 0B)
  Meta:
    Flags: 0
    Expiry: 0
    Locktime: 0
    CAS: 1611751097702088704
    Revseqno: 1
    Datatype: 3 (snappy,json)
  Value:
    {
        "id": 10,
        "type": "airline",
        "name": "40\-Mile Air",
        "iata": "Q5",
        "icao": "MLA",
        "callsign": "MILE\-AIR",
        "country": "United States"
    }

\-\- Backup 2021\-01\-27T12_41_13.009708335Z \-\-
Description: Mutation for document with key \*(Aqairline_10\*(Aq
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
Bucket: travel\-sample (13c11d3be4bfba95f9e4da73bf8d1960)
Scope: inventory (8)
Collection: airline (10)
Document:
  Key: airline_10
  Sequence Number: 75
  Deleted: false
  Size: 191B (Key: 10B) (Meta: 29B) (Value: 152B) (XATTRS: 0B)
  Meta:
    Flags: 33554438
    Expiry: 0
    Locktime: 0
    CAS: 1611751269058281472
    Revseqno: 2
    Datatype: 3 (snappy,json)
  Value:
    {
        "id": 10,
        "type": "airline",
        "name": "40\-Mile Air",
        "iata": "Q5",
        "icao": "MLA",
        "callsign": "MILE\-AIR",
        "country": "United States",
        "new_field": "new_value"
    }

\-\- Backup 2021\-01\-27T12_42_07.578485175Z \-\-
Description: Deletion for document with key \*(Aqairline_10\*(Aq
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
Bucket: travel\-sample (13c11d3be4bfba95f9e4da73bf8d1960)
Scope: inventory (8)
Collection: airline (10)
Document:
  Key: airline_10
  Sequence Number: 76
  Deleted: true
  Size: 39B (Key: 10B) (Meta: 29B) (Value: 0B) (XATTRS: 0B)
  Meta:
    Flags: 0
    Expiry: 0
    Locktime: 0
    CAS: 1611751325090316288
    Revseqno: 3
    Datatype: 0 (binary)

\-\- Backup 2021\-01\-27T12_42_18.322132022Z \-\-
Description: Collection \*(Aqairline\*(Aq dropped
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
Bucket: travel\-sample (13c11d3be4bfba95f9e4da73bf8d1960)
Scope: inventory (8)

\-\- Backup 2021\-01\-27T12_42_23.72226735Z \-\-
Description: Scope \*(Aqinventory\*(Aq dropped
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
Bucket: travel\-sample (13c11d3be4bfba95f9e4da73bf8d1960)

\-\- Backup 2021\-01\-27T12_42_34.08410595Z \-\-
Description: Bucket \*(Aqtravel\-sample\*(Aq dropped
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92

\-\- Backup 2021\-01\-27T12_42_35.395081659Z \-\-
Description: Bucket \*(Aqtravel\-sample\*(Aq not found
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
.fam
.fi
.if n .RE
.sp
When searching are large range of backups, the \f(CR\-\-start\fP and \f(CR\-\-end\fP flags (see
START AND END for more information) may be used to filter which backups are
searched.
.sp
.if n .RS 4
.nf
.fam C
$ cbbackupmgr examine \-a ~/Projects/couchbase\-archive \-r repo \-\-collection\-string \*(Aqtravel\-sample.inventory.airline\*(Aq \-\-key \*(Aqairline_10\*(Aq \-\-start 2021\-01\-27T12_42_18.322132022Z \-\-end 2021\-01\-27T12_42_35.395081659Z
\-\- Backup 2021\-01\-27T12_42_18.322132022Z \-\-
Description: Collection \*(Aqairline\*(Aq not found
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
Bucket: travel\-sample (13c11d3be4bfba95f9e4da73bf8d1960)
Scope: inventory (8)

\-\- Backup 2021\-01\-27T12_42_23.72226735Z \-\-
Description: Scope \*(Aqinventory\*(Aq dropped
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
Bucket: travel\-sample (13c11d3be4bfba95f9e4da73bf8d1960)

\-\- Backup 2021\-01\-27T12_42_34.08410595Z \-\-
Description: Bucket \*(Aqtravel\-sample\*(Aq dropped
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92

\-\- Backup 2021\-01\-27T12_42_35.395081659Z \-\-
Description: Bucket \*(Aqtravel\-sample\*(Aq not found
Cluster UUID: 4fb26863aa5224ff97c9f17415c7bd92
.fam
.fi
.if n .RE
.sp
By default, the examine will output binary documents as a hexdump (for the human
readable format) and as a hexstring (for the JSON format).
.sp
.if n .RS 4
.nf
.fam C
$ cbbackupmgr examine \-a $PWD/archive \-r repo \-\-collection\-string \*(Aqdefault\*(Aq \-\-key \*(Aqpymc0\*(Aq
\-\- Backup 2021\-01\-27T14_00_38.445404421Z \-\-
Description: First occurrence of key \*(Aqpymc0\*(Aq in this timeline, document created
Cluster UUID: 59845c6cdce57b81bd6f450e5043bee7
Bucket: default (7c8cb0f0bb9e2835d79e8dd91a5b0d67)
Document:
  Key: pymc0
  Sequence Number: 1
  Deleted: false
  Size: 84B (Key: 5B) (Meta: 29B) (Value: 50B) (XATTRS: 0B)
  Meta:
    Flags: 0
    Expiry: 0
    Locktime: 0
    CAS: 1611756033524170752
    Revseqno: 1
    Datatype: 0 (binary)
  Value:
    00000000  4d 59 4e 42 49 51 50 4d  5a 4a 50 4c 53 47 51 45  |MYNBIQPMZJPLSGQE|
    00000010  4a 45 59 44 54 5a 49 52  57 5a 54 45 4a 44 58 43  |JEYDTZIRWZTEJDXC|
    00000020  56 4b 50 52 44 4c 4e 4b  54 55 47 52 50 4f 51 49  |VKPRDLNKTUGRPOQI|
    00000030  42 5a                                             |BZ|

$ cbbackupmgr examine \-a $PWD/archive \-r repo \-\-collection\-string \*(Aqdefault\*(Aq \-\-key \*(Aqpymc0\*(Aq \-\-json | jq
[
  {
    "backup": "2021\-01\-27T14_00_38.445404421Z",
    "event_type": 1,
    "event_description": "First occurrence of key \*(Aqpymc0\*(Aq in this timeline, document created",
    "cluster_uuid": "59845c6cdce57b81bd6f450e5043bee7",
    "bucket_uuid": "7c8cb0f0bb9e2835d79e8dd91a5b0d67",
    "scope_id": 0,
    "collection_id": 0,
    "document": {
      "key": "pymc0",
      "sequence_number": 1,
      "value": "4d594e424951504d5a4a504c534751454a455944545a4952575a54454a445843564b5052444c4e4b54554752504f5149425a",
      "metadata": {
        "flags": 0,
        "expiry": 0,
        "locktime": 0,
        "cas": 1611756033524170800,
        "revseqno": 1,
        "datatype": 0
      },
      "deleted": false
    }
  }
]
.fam
.fi
.if n .RE
.SH "ENVIRONMENT AND CONFIGURATION VARIABLES"
.sp
CB_ARCHIVE_PATH
.RS 4
Specifies the path to the backup archive. If the archive path is supplied as
a command line argument then this value is overridden.
.RE
.sp
CB_OBJSTORE_STAGING_DIRECTORY
.RS 4
Specifies the path to the staging directory. If the \f(CR\-\-obj\-staging\-dir\fP
argument is provided in the command line then this value is overridden.
.RE
.sp
CB_OBJSTORE_REGION
.RS 4
Specifies the object store region. If the \f(CR\-\-obj\-region\fP argument is provided
in the command line then this value is overridden.
.RE
.sp
CB_OBJSTORE_ACCESS_KEY_ID
.RS 4
Specifies the object store access key id. If the \f(CR\-\-obj\-access\-key\-id\fP
argument is provided in the command line this value is overridden.
.RE
.sp
CB_OBJSTORE_SECRET_ACCESS_KEY
.RS 4
Specifies the object store secret access key. If the
\f(CR\-\-obj\-secret\-access\-key\fP argument is provided in the command line this value
is overridden.
.RE
.sp
CB_OBJSTORE_REFRESH_TOKEN
.RS 4
Specifies the refresh token to use. If the \f(CR\-\-obj\-refresh\-token\fP argument is
provided in the command line, this value is overridden.
.RE
.sp
CB_AWS_ENABLE_EC2_METADATA
.RS 4
By default cbbackupmgr will disable fetching EC2 instance metadata. Setting
this environment variable to true will allow the AWS SDK to fetch metadata
from the EC2 instance endpoint.
.RE
.sp
CB_ENCRYPTION_PASSPHRASE
.RS 4
Specifies the passphrase used for encryption.
.RE
.sp
CB_KM_KEY_URL
.RS 4
Specifies the URL identifying the encryption key on the KMS. See
\f(CR\-\-km\-key\-url\fP for the expected format and accepted KMSs.
.RE
.sp
CB_KM_ACCESS_ID
.RS 4
Specifies the key/user ID used to connect to the KMS.
.RE
.sp
CB_KM_SECRET_ACCESS_KEY
.RS 4
Specifies the secret key/token used to connect to the KMS.
.RE
.sp
CB_KM_AUTH_FILE
.RS 4
Specifies a path to a file containing the required credentials to connect to
the KMS.
.RE
.SH "SEE ALSO"
.sp
\fBcbbackupmgr\-cloud\fP(7)
.SH "CBBACKUPMGR"
.sp
Part of the \fBcbbackupmgr\fP(1) suite
.SH "AUTHOR"
.sp
Couchbase